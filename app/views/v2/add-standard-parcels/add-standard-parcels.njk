{% extends "_layout.njk" %}

{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/back-link/macro.njk" import govukBackLink %}
{% from "govuk/components/warning-text/macro.njk" import govukWarningText %}
{% from "govuk/components/checkboxes/macro.njk" import govukCheckboxes %}
{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/error-summary/macro.njk" import govukErrorSummary %}
{% from "./v2/sidebar/sidebar.njk" import sidebar %}


{% block beforeContent %}
  {{ govukBackLink({
    text: "Back",
    href: "/v2/standards"
  }) }}
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <form method="POST" autocomplete="off" novalidate>
      <input type="hidden" name="crumb" value="{{crumb}}"/>
      <div class="govuk-form-group">
        <fieldset class="govuk-fieldset" aria-describedby="parcels-hint">
          <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
            <h1 class="govuk-fieldset__heading">
              Add parcels to standard
            </h1>
          </legend>
          <div id="parcels-hint" class="govuk-hint">
            You have {{ totalHa }}ha of eligible land for this standard
          </div>

          {% if invalidValues %}
            {{ govukErrorSummary({
              titleText: "There is a problem",
              errorList: [
                {
                  text: "Please enter valid values"
                }
              ]
            }) }}
          {% endif %}
          {% if error %}
            <span id="parcels-error" class="govuk-error-message">
              <span class="govuk-visually-hidden">Error:</span> Please select a parcel
            </span>
          {% endif %}

          {% if checkboxItems.length > 0 %}
            <div class="govuk-checkboxes" data-module="govuk-checkboxes">
              {% for item in checkboxItems %}
                <div class="govuk-checkboxes__item">
                {% if item.checked %}
                  <input class="govuk-checkboxes__input" id="{{ item.value }}" name="parcels" type="checkbox" value="{{ item.value }}" data-aria-controls="conditional_{{ item.value }}" checked>
                {% else %}
                  <input class="govuk-checkboxes__input" id="{{ item.value }}" name="parcels" type="checkbox" value="{{ item.value }}" data-aria-controls="conditional_{{ item.value }}">
                {% endif %}
                  <label class="govuk-label govuk-checkboxes__label" for="{{ item.value }}">
                    {{ item.text}}
                  </label>
                  <div class="govuk-checkboxes__conditional govuk-checkboxes__conditional--hidden" id="conditional_{{ item.value }}">
                    <div class="govuk-form-group">
                      <label class="govuk-label" for="hectares_{{ item.value }}">
                        Hectares to use in this land parcel
                      </label>                     
                        <input class="govuk-input govuk-!-width-one-third" name="parcelArea_{{ item.value }}" value="{{ item.textBoxValue }}" type="text" spellcheck="false" autocomplete="false">                      
                    </div>
                  </div>
                  {% if item.warnings.length > 0 %}
                    <div class="govuk-warning-text">
                    {% for warning in item.warnings %}
                      {% if warning.SSSI === true %}
                        <p>
                          <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
                          <strong class="govuk-warning-text__text">
                          <span class="govuk-warning-text__assistive">Warning</span>
                            Potential SSSI conflict
                          </strong>
                        </p>
                      {% endif %}
                      {% if warning.HEFER === true %}
                        <p>
                          <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
                          <strong class="govuk-warning-text__text">
                          <span class="govuk-warning-text__assistive">Warning</span>
                            Potential HEFER conflict
                          </strong>
                        </p>
                      {% endif %}
                      {% if warning.SFI === true %}
                        <p>
                          <span class="govuk-warning-text__icon" aria-hidden="true">!</span>
                          <strong class="govuk-warning-text__text">
                            <span class="govuk-warning-text__assistive">Warning</span>
                            Potential SFI conflict
                          </strong>
                        </p>
                      {% endif %}
                    {% endfor %}
                    </div>
                  {% endif %}
                </div>
              {% endfor %}
            </div>
          {% endif %}
        </fieldset>
      </div>

      {{ govukButton({
        text: "Continue"
      }) }}
    </form>
  </div>
  {{ sidebar("Overview", sidebarItems) }}
</div>
{% endblock %}
